object DmRetaguarda: TDmRetaguarda
  OldCreateOrder = False
  OnCreate = DataModuleCreate
  OnDestroy = DataModuleDestroy
  Height = 494
  Width = 597
  object qryRetaguarda: TFDQuery
    Connection = DmConexao.FDConnection
    SQL.Strings = (
      ' '
      '   SELECT'
      '   '#9'TAB_LOJA.NUM_CGC, '
      '   '#9'TAB_LOJA.DES_LOJA AS DES_LOJA, '
      '   '#9'TAB_FLUXO.COD_PARCEIRO, '
      '   '#9'TAB_FLUXO.DES_PARCEIRO, '
      '   '#9'TAB_FLUXO.COD_BANDEIRA, '
      '   '#9'TAB_BANDEIRA.DES_BANDEIRA, '
      '   '#9'TAB_FLUXO.DTA_EMISSAO, '
      '   '#9'TAB_FLUXO.DTA_ENTRADA, '
      '   '#9'TAB_FLUXO.DTA_VENCIMENTO, '
      '   '#9'TAB_FLUXO.VAL_PARCELA, '
      
        '   '#9'(TAB_FLUXO.VAL_PARCELA + (TAB_FLUXO.VAL_JUROS + TAB_FLUXO.VA' +
        'L_CREDITO)) - (TAB_FLUXO.VAL_DESCONTO '
      
        '   '#9' + TAB_FLUXO.VAL_DEVOLUCAO + TAB_FLUXO.VAL_RETENCAO + TAB_FL' +
        'UXO.VAL_TAXA_ADM) + TAB_FLUXO.VAL_OUTROS AS VAL_LIQUIDO, '
      '   '#9'TAB_FLUXO.COD_ADMINISTRADORA_TEF, '
      '   '#9'TAB_FLUXO.NUM_BIN_TEF, '
      '   '#9'TAB_FLUXO.NUM_NSU_HOST_TEF, '
      '   '#9'TAB_FLUXO.COD_TRANSACAO_TEF, '
      '   '#9'TAB_FLUXO.COD_INSTITUICAO_TEF, '
      '   '#9'TAB_FLUXO.COD_BANDEIRA_TEF, '
      '   '#9'TAB_FLUXO.NUM_NSU_SITEF, '
      '   '#9'TAB_FLUXO.COD_AUTORIZACAO_TEF, '
      '   '#9'TAB_FLUXO.COD_ESTABELECIMENTO_TEF, '
      '   '#9'TAB_FLUXO.VAL_TOTAL_NF, '
      '   '#9'TAB_FLUXO.NUM_PARCELA, '
      '   '#9'TAB_FLUXO.QTD_PARCELA, '
      '        TAB_FLUXO.COD_CHAVE, '
      '        TAB_FLUXO.NUM_BORDERO'
      ''
      '   FROM TAB_FLUXO '
      '   INNER JOIN TAB_BANDEIRA ON '
      '    TAB_FLUXO.COD_BANDEIRA = TAB_BANDEIRA.COD_BANDEIRA '
      '   INNER JOIN TAB_LOJA ON '
      '    TAB_FLUXO.COD_LOJA = TAB_LOJA.COD_LOJA '
      '   WHERE '
      '   TAB_LOJA.NUM_CGC = :NUM_CGC '
      '   AND TAB_FLUXO.DTA_EMISSAO = :DTA_EMISSAO '
      '   AND TAB_FLUXO.COD_AUTORIZACAO_TEF = :COD_AUTORIZACAO_TEF  ')
    Left = 32
    Top = 8
    ParamData = <
      item
        Name = 'NUM_CGC'
        DataType = ftString
        ParamType = ptInput
        Value = Null
      end
      item
        Name = 'DTA_EMISSAO'
        DataType = ftDate
        ParamType = ptInput
        Value = Null
      end
      item
        Name = 'COD_AUTORIZACAO_TEF'
        DataType = ftString
        ParamType = ptInput
        Value = Null
      end>
    object qryRetaguardaNUM_CGC: TStringField
      FieldName = 'NUM_CGC'
      Origin = 'NUM_CGC'
      Size = 19
    end
    object qryRetaguardaDES_LOJA: TStringField
      FieldName = 'DES_LOJA'
      Origin = 'DES_LOJA'
      Required = True
      Size = 50
    end
    object qryRetaguardaCOD_PARCEIRO: TBCDField
      FieldName = 'COD_PARCEIRO'
      Origin = 'COD_PARCEIRO'
      ProviderFlags = [pfInUpdate, pfInWhere, pfInKey]
      Required = True
      Precision = 10
      Size = 0
    end
    object qryRetaguardaDES_PARCEIRO: TStringField
      FieldName = 'DES_PARCEIRO'
      Origin = 'DES_PARCEIRO'
      Size = 50
    end
    object qryRetaguardaCOD_BANDEIRA: TBCDField
      FieldName = 'COD_BANDEIRA'
      Origin = 'COD_BANDEIRA'
      Precision = 10
      Size = 0
    end
    object qryRetaguardaDES_BANDEIRA: TStringField
      FieldName = 'DES_BANDEIRA'
      Origin = 'DES_BANDEIRA'
      Required = True
      Size = 50
    end
    object qryRetaguardaDTA_EMISSAO: TDateTimeField
      FieldName = 'DTA_EMISSAO'
      Origin = 'DTA_EMISSAO'
    end
    object qryRetaguardaDTA_ENTRADA: TDateTimeField
      FieldName = 'DTA_ENTRADA'
      Origin = 'DTA_ENTRADA'
    end
    object qryRetaguardaDTA_VENCIMENTO: TDateTimeField
      FieldName = 'DTA_VENCIMENTO'
      Origin = 'DTA_VENCIMENTO'
    end
    object qryRetaguardaVAL_PARCELA: TFloatField
      FieldName = 'VAL_PARCELA'
      Origin = 'VAL_PARCELA'
      Required = True
    end
    object qryRetaguardaVAL_LIQUIDO: TFloatField
      FieldName = 'VAL_LIQUIDO'
      Origin = 'VAL_LIQUIDO'
    end
    object qryRetaguardaCOD_ADMINISTRADORA_TEF: TStringField
      FieldName = 'COD_ADMINISTRADORA_TEF'
      Origin = 'COD_ADMINISTRADORA_TEF'
    end
    object qryRetaguardaNUM_BIN_TEF: TBCDField
      FieldName = 'NUM_BIN_TEF'
      Origin = 'NUM_BIN_TEF'
      Precision = 10
      Size = 0
    end
    object qryRetaguardaNUM_NSU_HOST_TEF: TStringField
      FieldName = 'NUM_NSU_HOST_TEF'
      Origin = 'NUM_NSU_HOST_TEF'
      Size = 15
    end
    object qryRetaguardaCOD_TRANSACAO_TEF: TBCDField
      FieldName = 'COD_TRANSACAO_TEF'
      Origin = 'COD_TRANSACAO_TEF'
      Precision = 10
      Size = 0
    end
    object qryRetaguardaCOD_INSTITUICAO_TEF: TStringField
      FieldName = 'COD_INSTITUICAO_TEF'
      Origin = 'COD_INSTITUICAO_TEF'
      Size = 5
    end
    object qryRetaguardaCOD_BANDEIRA_TEF: TBCDField
      FieldName = 'COD_BANDEIRA_TEF'
      Origin = 'COD_BANDEIRA_TEF'
      Precision = 10
      Size = 0
    end
    object qryRetaguardaNUM_NSU_SITEF: TStringField
      FieldName = 'NUM_NSU_SITEF'
      Origin = 'NUM_NSU_SITEF'
      Size = 15
    end
    object qryRetaguardaCOD_AUTORIZACAO_TEF: TBCDField
      FieldName = 'COD_AUTORIZACAO_TEF'
      Origin = 'COD_AUTORIZACAO_TEF'
      Precision = 10
      Size = 0
    end
    object qryRetaguardaCOD_ESTABELECIMENTO_TEF: TStringField
      FieldName = 'COD_ESTABELECIMENTO_TEF'
      Origin = 'COD_ESTABELECIMENTO_TEF'
      Size = 50
    end
    object qryRetaguardaVAL_TOTAL_NF: TFloatField
      FieldName = 'VAL_TOTAL_NF'
      Origin = 'VAL_TOTAL_NF'
      Required = True
    end
    object qryRetaguardaNUM_PARCELA: TBCDField
      FieldName = 'NUM_PARCELA'
      Origin = 'NUM_PARCELA'
      Required = True
      Precision = 5
      Size = 0
    end
    object qryRetaguardaQTD_PARCELA: TBCDField
      FieldName = 'QTD_PARCELA'
      Origin = 'QTD_PARCELA'
      Required = True
      Precision = 5
      Size = 0
    end
    object qryRetaguardaCOD_CHAVE: TBCDField
      FieldName = 'COD_CHAVE'
      Origin = 'COD_CHAVE'
      Required = True
      Precision = 10
      Size = 0
    end
    object qryRetaguardaNUM_BORDERO: TBCDField
      FieldName = 'NUM_BORDERO'
      Origin = 'NUM_BORDERO'
      Required = True
      Precision = 10
      Size = 0
    end
  end
  object qryAtualizaTitulo: TFDQuery
    Connection = DmConexao.FDConnection
    SQL.Strings = (
      'update tab_fluxo '
      'set num_bordero = :num_bordero '
      'where '
      'cod_chave = :cod_chave')
    Left = 31
    Top = 70
    ParamData = <
      item
        Name = 'NUM_BORDERO'
        DataType = ftInteger
        ParamType = ptInput
        Value = Null
      end
      item
        Name = 'COD_CHAVE'
        DataType = ftInteger
        ParamType = ptInput
        Value = Null
      end>
  end
  object qryBordero: TFDQuery
    Connection = DmConexao.FDConnection
    SQL.Strings = (
      'SELECT '
      '  PROXIMO_VALOR'
      'FROM'
      '  TAB_PROXIMO_CODIGO'
      'WHERE '
      '  CAMPO = '#39'COD_BORDERO'#39' ')
    Left = 36
    Top = 111
    object qryBorderoPROXIMO_VALOR: TBCDField
      FieldName = 'PROXIMO_VALOR'
      Origin = 'PROXIMO_VALOR'
      Required = True
      Precision = 10
      Size = 0
    end
  end
  object DataSourceCartao: TDataSource
    DataSet = ClientDataSetCartao
    Left = 181
    Top = 16
  end
  object ClientDataSetCartao: TClientDataSet
    Aggregates = <>
    AggregatesActive = True
    Params = <>
    Left = 181
    Top = 56
    object StringField1: TStringField
      FieldName = 'NUM_CGC'
      Origin = 'NUM_CGC'
      Size = 19
    end
    object BCDField1: TBCDField
      FieldName = 'COD_PARCEIRO'
      Origin = 'COD_PARCEIRO'
      ProviderFlags = [pfInUpdate, pfInWhere, pfInKey]
      Required = True
      Precision = 10
      Size = 0
    end
    object StringField2: TStringField
      FieldName = 'DES_PARCEIRO'
      Origin = 'DES_PARCEIRO'
      Size = 50
    end
    object BCDField2: TBCDField
      FieldName = 'COD_BANDEIRA'
      Origin = 'COD_BANDEIRA'
      Precision = 10
      Size = 0
    end
    object StringField3: TStringField
      FieldName = 'DES_BANDEIRA'
      Origin = 'DES_BANDEIRA'
      Required = True
      Size = 50
    end
    object DateTimeField1: TDateTimeField
      FieldName = 'DTA_EMISSAO'
      Origin = 'DTA_EMISSAO'
    end
    object DateTimeField2: TDateTimeField
      FieldName = 'DTA_ENTRADA'
      Origin = 'DTA_ENTRADA'
    end
    object DateTimeField3: TDateTimeField
      FieldName = 'DTA_VENCIMENTO'
      Origin = 'DTA_VENCIMENTO'
    end
    object FloatField1: TFloatField
      FieldName = 'VAL_PARCELA'
      Origin = 'VAL_PARCELA'
      Required = True
    end
    object FloatField2: TFloatField
      FieldName = 'VAL_LIQUIDO'
      Origin = 'VAL_LIQUIDO'
    end
    object StringField4: TStringField
      FieldName = 'COD_ADMINISTRADORA_TEF'
      Origin = 'COD_ADMINISTRADORA_TEF'
    end
    object BCDField3: TBCDField
      FieldName = 'NUM_BIN_TEF'
      Origin = 'NUM_BIN_TEF'
      Precision = 10
      Size = 0
    end
    object StringField5: TStringField
      FieldName = 'NUM_NSU_HOST_TEF'
      Origin = 'NUM_NSU_HOST_TEF'
      Size = 15
    end
    object BCDField4: TBCDField
      FieldName = 'COD_TRANSACAO_TEF'
      Origin = 'COD_TRANSACAO_TEF'
      Precision = 10
      Size = 0
    end
    object StringField6: TStringField
      FieldName = 'COD_INSTITUICAO_TEF'
      Origin = 'COD_INSTITUICAO_TEF'
      Size = 5
    end
    object BCDField5: TBCDField
      FieldName = 'COD_BANDEIRA_TEF'
      Origin = 'COD_BANDEIRA_TEF'
      Precision = 10
      Size = 0
    end
    object StringField7: TStringField
      FieldName = 'NUM_NSU_SITEF'
      Origin = 'NUM_NSU_SITEF'
      Size = 15
    end
    object BCDField6: TBCDField
      FieldName = 'COD_AUTORIZACAO_TEF'
      Origin = 'COD_AUTORIZACAO_TEF'
      Precision = 10
      Size = 0
    end
    object StringField8: TStringField
      FieldName = 'COD_ESTABELECIMENTO_TEF'
      Origin = 'COD_ESTABELECIMENTO_TEF'
      Size = 50
    end
    object FloatField3: TFloatField
      FieldName = 'VAL_TOTAL_NF'
      Origin = 'VAL_TOTAL_NF'
      Required = True
    end
    object BCDField7: TBCDField
      FieldName = 'NUM_PARCELA'
      Origin = 'NUM_PARCELA'
      Required = True
      Precision = 5
      Size = 0
    end
    object BCDField8: TBCDField
      FieldName = 'QTD_PARCELA'
      Origin = 'QTD_PARCELA'
      Required = True
      Precision = 5
      Size = 0
    end
    object StringField9: TStringField
      FieldName = 'DES_LOJA'
      Size = 50
    end
    object ClientDataSetCartaoCOD_CHAVE: TIntegerField
      FieldName = 'COD_CHAVE'
    end
    object ClientDataSetCartaoNUM_BORDERO: TIntegerField
      FieldName = 'NUM_BORDERO'
    end
    object ClientDataSetCartaoQtdRegErp: TAggregateField
      FieldName = 'QtdRegErp'
      Active = True
      DisplayName = 'Qtde. Reg. Erp'
      Expression = 'count(*)'
    end
    object ClientDataSetCartaoval_bruto: TAggregateField
      DisplayLabel = 'Val. Bruto'
      FieldName = 'val_bruto'
      Active = True
      DisplayName = 'val_bruto'
      Expression = 'sum(val_liquido) '
    end
  end
  object qryAtualizaNumBordero: TFDQuery
    Connection = DmConexao.FDConnection
    SQL.Strings = (
      'UPDATE TAB_PROXIMO_CODIGO'
      'SET PROXIMO_VALOR = PROXIMO_VALOR + 1 '
      'WHERE '
      'CAMPO = '#39'COD_BORDERO'#39)
    Left = 56
    Top = 184
  end
  object ClientDataSetAdmBand: TClientDataSet
    Aggregates = <>
    Params = <>
    Left = 336
    Top = 32
    object ClientDataSetAdmBandCOD_ADMINISTRADORA: TIntegerField
      FieldName = 'COD_ADMINISTRADORA'
    end
    object ClientDataSetAdmBandCOD_BANDEIRA: TIntegerField
      FieldName = 'COD_BANDEIRA'
    end
    object ClientDataSetAdmBandDATA_VENCIMENTO: TDateField
      FieldName = 'DATA_VENCIMENTO'
    end
  end
end
